// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.sqlite"
}

// datasource db {
//   provider = "postgresql"
//   url      = env("DATABASE_URL")
// }

generator nestjsDto {
  provider                        = "prisma-generator-nestjs-dto"
  output                          = "../src/generated/nestjs-dto"
  outputToNestJsResourceStructure = "false"
  exportRelationModifierClasses   = "true"
  reExport                        = "false"
  createDtoPrefix                 = "Create"
  updateDtoPrefix                 = "Update"
  dtoSuffix                       = "Dto"
  entityPrefix                    = ""
  entitySuffix                    = "Entity"
  fileNamingStyle                 = "camel"
}

model User {
  id                     String    @id @default(uuid())
  email                  String    @unique
  name                   String
  password               String
  isEmailConfirmed       Boolean   @default(false)
  emailConfirmationToken String
  projects               Project[]
}

model Project {
  id       String   @id @default(uuid())
  title    String
  content  String
  user     User     @relation(fields: [userId], references: [id])
  userId String
  lines    Line[]
  parcels  Parcel[]
}

model Line {
  id         String       @id @default(uuid())
  title      String
  lineCoords LineCoords[]
  project    Project      @relation(fields: [projectId], references: [id])
  projectId  String
}

model LineCoords {
  id     String @id @default(uuid())
  x      Float
  y      Float
  line   Line   @relation(fields: [lineId], references: [id])
  lineId String
}

model Parcel {
  id           String         @id @default(uuid())
  voivodeship  String
  county       String
  commune      String
  KW           String?
  class        String?
  parcelBounds ParcelBounds[]
  owners       Owner[]
  Project      Project?       @relation(fields: [projectId], references: [id])
  projectId    String?
}

model ParcelBounds {
  id       String @id @default(uuid())
  x        Float
  y        Float
  parcel   Parcel @relation(fields: [parcelId], references: [id])
  parcelId String
}

model Owner {
  id         String   @id @default(uuid())
  name       String
  surname    String
  streetName String?
  homeNumber String?
  city       String?
  postalCode String?
  parcels    Parcel[]
  projectId  String?
}

// model OwnersOnProjects {
//   project    Project  @relation(fields: [projectId], references: [id])
//   projectId  String // relation scalar field (used in the `@relation` attribute above)
//   owner      Owner    @relation(fields: [ownerId], references: [id])
//   ownerId    String // relation scalar field (used in the `@relation` attribute above)
//   assignedAt DateTime @default(now())

//   @@id([projectId, ownerId])
// }
